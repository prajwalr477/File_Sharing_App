{"ast":null,"code":"var _jsxFileName = \"F:\\\\projects\\\\File-Share2\\\\client\\\\src\\\\FileShare\\\\FileShare.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect } from \"react\";\nimport { io } from \"socket.io-client\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst SenderApp = () => {\n  _s();\n  const [joinID, setJoinID] = useState(\"\");\n  const [activeScreen, setActiveScreen] = useState(\"join-screen\");\n  const [file, setFile] = useState(null);\n  const socket = useRef(null);\n  const bufferRef = useRef(null);\n  const progressRef = useRef(0);\n  useEffect(() => {\n    socket.current = io(\"http://localhost:5000\");\n    socket.current.on(\"init\", () => {\n      setActiveScreen(\"fs-screen\");\n    });\n    socket.current.on(\"fs-share\", sendNextChunk);\n    return () => {\n      socket.current.disconnect();\n    };\n  }, []);\n  const generateID = () => `${Math.trunc(Math.random() * 999)}-${Math.trunc(Math.random() * 999)}-${Math.trunc(Math.random() * 999)}`;\n  const handleCreateRoom = () => {\n    const newJoinID = generateID();\n    setJoinID(newJoinID);\n    socket.current.emit(\"sender-join\", {\n      uid: newJoinID\n    });\n  };\n  const handleFileChange = e => {\n    const selectedFile = e.target.files[0];\n    if (!selectedFile) return;\n    const reader = new FileReader();\n    reader.onload = () => {\n      const buffer = new Uint8Array(reader.result);\n      bufferRef.current = buffer;\n      progressRef.current = 0;\n      setFile({\n        name: selectedFile.name,\n        size: buffer.length\n      });\n      socket.current.emit(\"file-meta\", {\n        uid: joinID,\n        metadata: {\n          filename: selectedFile.name,\n          total_buffer_size: buffer.length,\n          buffer_size: 1024\n        }\n      });\n    };\n    reader.readAsArrayBuffer(selectedFile);\n  };\n  const sendNextChunk = () => {\n    const chunkSize = 1024;\n    const chunk = bufferRef.current.slice(0, chunkSize);\n    bufferRef.current = bufferRef.current.slice(chunkSize);\n    socket.current.emit(\"file-raw\", {\n      uid: joinID,\n      buffer: chunk\n    });\n    progressRef.current += chunk.length;\n    if (file) {\n      const progress = Math.trunc(progressRef.current / file.size * 100);\n      setFile(prev => ({\n        ...prev,\n        progress\n      }));\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"app\",\n    children: [activeScreen === \"join-screen\" && /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Create a Room\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleCreateRoom,\n        children: \"Create Room\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 11\n      }, this), joinID && /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Room ID: \", joinID]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 22\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 9\n    }, this), activeScreen === \"fs-screen\" && /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        children: \"Share a File\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"file\",\n        onChange: handleFileChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 11\n      }, this), file && /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: file.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: [\"Progress: \", file.progress || 0, \"%\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 94,\n          columnNumber: 15\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 13\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 78,\n    columnNumber: 5\n  }, this);\n};\n_s(SenderApp, \"rXZmujoEJz6ui4XYVn55P8BUJ3Q=\");\n_c = SenderApp;\nexport default SenderApp;\nvar _c;\n$RefreshReg$(_c, \"SenderApp\");","map":{"version":3,"names":["React","useState","useRef","useEffect","io","jsxDEV","_jsxDEV","SenderApp","_s","joinID","setJoinID","activeScreen","setActiveScreen","file","setFile","socket","bufferRef","progressRef","current","on","sendNextChunk","disconnect","generateID","Math","trunc","random","handleCreateRoom","newJoinID","emit","uid","handleFileChange","e","selectedFile","target","files","reader","FileReader","onload","buffer","Uint8Array","result","name","size","length","metadata","filename","total_buffer_size","buffer_size","readAsArrayBuffer","chunkSize","chunk","slice","progress","prev","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","type","onChange","_c","$RefreshReg$"],"sources":["F:/projects/File-Share2/client/src/FileShare/FileShare.jsx"],"sourcesContent":["import React, { useState, useRef, useEffect } from \"react\";\r\nimport { io } from \"socket.io-client\";\r\n\r\nconst SenderApp = () => {\r\n  const [joinID, setJoinID] = useState(\"\");\r\n  const [activeScreen, setActiveScreen] = useState(\"join-screen\");\r\n  const [file, setFile] = useState(null);\r\n  const socket = useRef(null);\r\n  const bufferRef = useRef(null);\r\n  const progressRef = useRef(0);\r\n\r\n  useEffect(() => {\r\n    socket.current = io(\"http://localhost:5000\");\r\n\r\n    socket.current.on(\"init\", () => {\r\n      setActiveScreen(\"fs-screen\");\r\n    });\r\n\r\n    socket.current.on(\"fs-share\", sendNextChunk);\r\n\r\n    return () => {\r\n      socket.current.disconnect();\r\n    };\r\n  }, []);\r\n\r\n  const generateID = () =>\r\n    `${Math.trunc(Math.random() * 999)}-${Math.trunc(\r\n      Math.random() * 999\r\n    )}-${Math.trunc(Math.random() * 999)}`;\r\n\r\n  const handleCreateRoom = () => {\r\n    const newJoinID = generateID();\r\n    setJoinID(newJoinID);\r\n    socket.current.emit(\"sender-join\", { uid: newJoinID });\r\n  };\r\n\r\n  const handleFileChange = (e) => {\r\n    const selectedFile = e.target.files[0];\r\n    if (!selectedFile) return;\r\n\r\n    const reader = new FileReader();\r\n    reader.onload = () => {\r\n      const buffer = new Uint8Array(reader.result);\r\n      bufferRef.current = buffer;\r\n      progressRef.current = 0;\r\n      setFile({\r\n        name: selectedFile.name,\r\n        size: buffer.length,\r\n      });\r\n\r\n      socket.current.emit(\"file-meta\", {\r\n        uid: joinID,\r\n        metadata: {\r\n          filename: selectedFile.name,\r\n          total_buffer_size: buffer.length,\r\n          buffer_size: 1024,\r\n        },\r\n      });\r\n    };\r\n    reader.readAsArrayBuffer(selectedFile);\r\n  };\r\n\r\n  const sendNextChunk = () => {\r\n    const chunkSize = 1024;\r\n    const chunk = bufferRef.current.slice(0, chunkSize);\r\n    bufferRef.current = bufferRef.current.slice(chunkSize);\r\n\r\n    socket.current.emit(\"file-raw\", { uid: joinID, buffer: chunk });\r\n\r\n    progressRef.current += chunk.length;\r\n    if (file) {\r\n      const progress = Math.trunc((progressRef.current / file.size) * 100);\r\n      setFile((prev) => ({ ...prev, progress }));\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"app\">\r\n      {activeScreen === \"join-screen\" && (\r\n        <div>\r\n          <h2>Create a Room</h2>\r\n          <button onClick={handleCreateRoom}>Create Room</button>\r\n          {joinID && <p>Room ID: {joinID}</p>}\r\n        </div>\r\n      )}\r\n\r\n      {activeScreen === \"fs-screen\" && (\r\n        <div>\r\n          <h2>Share a File</h2>\r\n          <input type=\"file\" onChange={handleFileChange} />\r\n          {file && (\r\n            <div>\r\n              <p>{file.name}</p>\r\n              <p>Progress: {file.progress || 0}%</p>\r\n            </div>\r\n          )}\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SenderApp;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}